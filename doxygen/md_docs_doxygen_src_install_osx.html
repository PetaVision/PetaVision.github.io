<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>PetaVision: OS X Installation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PetaVision
   &#160;<span id="projectnumber">Alpha</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md_docs_doxygen_src_install_osx.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">OS X Installation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This is a tutorial on getting PetaVision installed and running on OS X, assuming you have a clean installation of OS X. You will need an admin account (for installing packages with sudo). Tested on OS X 10.10.5 (Yosemite). If you have an NVIDIA card and upgrade to Yosemite, you will need to reinstall cuDNN.</p>
<h2>Requirements </h2>
<ul>
<li>OS X</li>
<li>sudo access</li>
</ul>
<h2>Required installations </h2>
<ul>
<li>Xcode and Xcode command line tools</li>
<li>Homebrew</li>
<li>GDAL</li>
</ul>
<h2>Optional installations </h2>
<ul>
<li>OpenMPI (to take advantage of MPI parallelization)</li>
<li>CUDA and cuDNN (to take advantage of CUDA GPU acceleration)</li>
<li>A C/C++ compiler with OpenMP capabilities (to take advantage of OpenMP parallelization)</li>
<li>Octave (to use the m-files in the mlab directory for analysis)</li>
</ul>
<h2>Xcode </h2>
<p>Xcode is needed to install Homebrew and C/C++ compilers. Here's how to get it.</p><ul>
<li>Go to the Apple App Store and search for Xcode</li>
<li>Click 'GET', then 'INSTALL'. Put in your Apple ID information</li>
<li>After it's installed, we need to accept the Xcode license.<ul>
<li>Run the Xcode application</li>
<li>Follow the onscreen prompt until you see the main Xcode screen</li>
<li>Exit Xcode</li>
</ul>
</li>
<li>We also need command line tools for Xcode<ul>
<li>Go into a terminal and execute the following command</li>
</ul>
</li>
</ul>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;xcode-select --install</div>
</div><!-- fragment --><ul>
<li>Follow the onscreen prompt to install command line tools.</li>
</ul>
<h2>Homebrew </h2>
<p>Homebrew is a package manager for OS X, which we will use for many of PetaVision's dependencies. Additional information can be found at <a href="http://brew.sh">http://brew.sh</a> To install homebrew:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</div>
</div><!-- fragment --><h2>Initialization </h2>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;brew update</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;brew install cmake</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;brew install wget</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;brew install gdal</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;# optionally, to install OpenMPI:</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;brew install open-mpi</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;# optionally, to install Octave using homebrew</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;# (note: installation of Octave on a fresh system typically takes several hours):</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;brew tap homebrew/science</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;brew install octave</div>
</div><!-- fragment --><p>If you want to take advantage of OpenMP threading, see below.</p>
<h2>OpenMP-compatible Clang (optional) </h2>
<p>Currently (OS X Yosemite 10.10.5 and Xcode 6.4), the version of Clang installed by Xcode does not support OpenMP. The program installed as gcc is also Clang, not GNU-GCC (as can be verified by running gcc &ndash;version). To make use of the OpenMP threading in PetaVision you will need an OpenMP-compatible compiler. As of this writing, the most recent release of Clang (3.7.0) supports OpenMP, but Xcode is still behind this version. Here are instructions to download the most recent version of clang.</p>
<h3>Install the OMP-compatible version of Clang</h3>
<p>Download the most recent pre-built binary for Mac OS X from <a href="http://llvm.org/releases/download.html">http://llvm.org/releases/download.html</a>. Make a note of the location of the downloaded file and the filename. In what follows, we will be using the filename <code>clang+llvm-3.7.0-x86_64-apple-darwin.tar.xz</code>, the most recent version as of this writing; modify as necessary. To extract the downloaded <code>.xz</code> file using the command line, you will need the xz program, which can be installed using Homebrew.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;brew install xz</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;cd ${HOME}</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;mkdir clang_omp</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;cd clang_omp</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;cp /path/to/clang+llvm-3.7.0-x86_64-apple-darwin.tar.xz .</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;unxz clang+llvm-3.7.0-x86_64-apple-darwin.tar.xz</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;tar xf clang+llvm-3.7.0-x86_64-apple-darwin.tar</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;cd clang+llvm-3.7.0-x86_64-apple-darwin/bin</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;ln -s clang cc</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;ln -s clang++ c++</div>
</div><!-- fragment --><h3>Install the OMP library</h3>
<p>Download the most recent version of the OpenMP Runtime Library from <a href="https://www.openmprtl.org/download#stable-releases">https://www.openmprtl.org/download#stable-releases</a>. Make a note of the location of the downloaded file. In what follows, we will be using <code>libomp_20150701_oss.tgz</code>, the most recent version as of this writing; modify as necessary. </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;cd ${HOME}/clang_omp</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;tar xf /path/to/libomp_20150701_oss.tgz</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;cd libomp_oss</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;cmake .</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;make</div>
</div><!-- fragment --><h3>Update necessary environmental variables</h3>
<p>Open your <code>~/.bash_profile</code> (or <code>~/.profile</code>, whichever one you use) and append these lines to the end of the file: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;export PATH=$HOME/clang_omp/clang+llvm-3.7.0-x86_64-apple-darwin/bin:$PATH</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;export C_INCLUDE_PATH=$HOME/clang_omp/clang+llvm-3.7.0-x86_64-apple-darwin/include:$C_INCLUDE_PATH</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;export CPLUS_INCLUDE_PATH=$HOME/clang_omp/clang+llvm-3.7.0-x86_64-apple-darwin/include:$CPLUS_INCLUDE_PATH</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;export LIBRARY_PATH=$HOME/clang_omp/clang+llvm-3.7.0-x86_64-apple-darwin/lib:$LIBRARY_PATH</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;export DYLD_LIBRARY_PATH=$HOME/clang_omp/clang+llvm-3.7.0-x86_64-apple-darwin/lib:$DYLD_LIBRARY_PATH</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;export C_INCLUDE_PATH=$HOME/clang_omp/libomp_oss/exports/common/include:$C_INCLUDE_PATH</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;export CPLUS_INCLUDE_PATH=$HOME/clang_omp/libomp_oss/exports/common/include:$CPLUS_INCLUDE_PATH</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;export LIBRARY_PATH=$HOME/clang_omp/libomp_oss/exports/mac_32e/lib.thin:$LIBRARY_PATH</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;export DYLD_LIBRARY_PATH=$HOME/clang_omp/libomp_oss/exports/mac_32e/lib.thin:$DYLD_LIBRARY_PATH</div>
</div><!-- fragment --><p>If you have any open terminal windows, run <code>source ~/.bash_profile</code> in each of them. Test by running <code>which clang</code> and <code>which clang++</code> to verify that clang and clang++ resolve to the versions just installed.</p>
<h2>CUDA and NVIDIA Driver (optional): </h2>
<p>To take advantage of CUDA/cuDNN GPU acceleration your Macintosh needs to have an NVIDIA card with compute capabilities 3.0 or above. To find which video card you have, go to "About This Mac" under the Apple menu, select "System Report..." and then Graphics/Displays in the Hardware section. Check at <a href="https://developer.nvidia.com/cuda-gpus">https://developer.nvidia.com/cuda-gpus</a> to see if your video card supports CUDA. NVIDIA drivers are included with the cuda download. To install cuda:</p><ul>
<li>Go to <a href="https://developer.nvidia.com/cuda-downloads">https://developer.nvidia.com/cuda-downloads</a></li>
<li>Select Mac OS X, and then your version of OS X and download the local installer .dmg</li>
<li>If the .dmg does not automatically open, double-click the .dmg file to mount the CUDAMacOSXInstaller disk.</li>
<li>Open the CUDAMacOSXInstaller/CUDAMacOSXInstaller app on that disk and follow the onscreen instructions.</li>
<li>Open the downloaded .pkg file and follow the onscreen instructions. On the Select Packages To Install page, make sure to select cuda driver and cuda toolkit.</li>
</ul>
<h2>cuDNN (optional) </h2>
<p>Go to <a href="https://developer.nvidia.com/cuDNN">https://developer.nvidia.com/cuDNN</a> and click Download at the bottom. Register with NVIDIA developers if need be, and wait for confirmation. Download the OS X version of cuDNN (Optional: if you have access to NMC's compuneuro, grab it from here: <code>/nh/compneuro/Data/cuDNN</code>)</p>
<h2>Checking Out and Installing PetaVision: </h2>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;cd ${HOME}</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;git clone https://github.com/PetaVision/OpenPV</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;cd OpenPV</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;git clone https://github.com/PetaVision/OpenPV</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;cd OpenPV</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;echo PVSystemTests &gt; subdirectories.txt</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;#Edit the file subdirectories.txt to include any desired projects or</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;#auxiliary libraries</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;ccmake .</div>
</div><!-- fragment --><p>CMake options: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;CLANG_OMP = (ON or OFF) #Turn this on if using a version of Clang that supports OpenMP as opposed to the Apple-supplied clang.</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;CMAKE_BUILD_TYPE = (Release or Debug) #Whether to optimize for performance or for debugging</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;...</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;CUDA_RELEASE = (ON or OFF) #Whether to Optimization for Cuda</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;CUDNN_PATH = /path/to/cudnn/folder #The path to the cuDNN folder you downloaded/copied</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;...</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;PV_USE_CUDA = (ON or OFF) #Whether to use CUDA GPU acceleration</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;PV_USE_CUDNN = True #Whether to use cuDNN</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;PV_USE_OPENMP_THREADS = (ON or OFF) #Whether to use OpenMP threading</div>
</div><!-- fragment --><p>Not all options will show up immediately the first time you run ccmake. Fill the ones you can, press c to configure, and look for new variables (marked with an asterisk). Fill in those variables and repeat.</p>
<p>Note: if you are using OpenMP but not using OpenMPI, then you should also set the cmake-built-in variables CMAKE_C_COMPILER and CMAKE_CXX_COMPILER. Press t to toggle advanced mode, and find the compiler variables. Replace their values with the full path to the clang and clang++ that you installed earlier. (If you are using OpenMPI, this is not necessary. Turning PV_USE_MPI on will use the MPI-supplied compilers, which wrap around c/clang and c++/clang++. Editing and exporting the PATH variable in .bash_profile or .profile made sure that the MPI compilers would find the new versions of the compilers.)</p>
<p>When all options have been set, press g to generate. (If that option does not appear, there are either new variables &ndash; press c to configure when they or filled in &ndash; or there is an error in some of the existing values.)</p>
<p>To Test: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;cd ~/workspace/PVSystemTest/BasicSystemTest</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;make -j 8</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;# Change Release to Debug in the line below if you built with CMAKE_BUILD_TYPE = Debug.</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Release/BasicSystemTest -p input/BasicSystemTest.params -t</div>
</div><!-- fragment --><p>To Test GPU capability:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;cd ~/workspace/PVSystemTest/GPUSystemTest</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;make -j 8</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;# Change Release to Debug in the line below if you built with CMAKE_BUILD_TYPE = Debug.</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Release/GPUSystemTest -p input/postTest.params -t</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
