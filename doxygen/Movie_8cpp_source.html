<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>PetaVision: src/layers/Movie.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PetaVision
   &#160;<span id="projectnumber">Alpha</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('Movie_8cpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Movie.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Movie.cpp</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *  Created on: Sep 25, 2009</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *      Author: travel</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;Movie.hpp&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;../include/default_params.h&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;assert.h&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;time.h&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;errno.h&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacePV.html">PV</a> {</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;Movie::Movie() {</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;   initialize_base();</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;}</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;Movie::Movie(<span class="keyword">const</span> <span class="keywordtype">char</span> * name, HyPerCol * hc) {</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;   initialize_base();</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;   initialize(name, hc);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;}</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;Movie::~Movie()</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;{</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;   <span class="keywordflow">if</span> (getParent()-&gt;icCommunicator()-&gt;commRank()==0 &amp;&amp; filenamestream != NULL &amp;&amp; filenamestream-&gt;isfile) {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      PV_fclose(filenamestream);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;   }</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;   <span class="keywordflow">if</span> (getParent()-&gt;icCommunicator()-&gt;commRank()==0 &amp;&amp; timestampFile != NULL &amp;&amp; timestampFile-&gt;isfile) {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;       PV_fclose(timestampFile);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;   }</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;   <span class="keywordflow">if</span>(movieOutputPath){</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      free(movieOutputPath);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;   }</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;   <span class="keywordflow">if</span>(framePath){</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b = 0; b &lt; parent-&gt;getNBatch(); b++){</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;         <span class="keywordflow">if</span>(framePath[b]){</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;            free(framePath[b]);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;         }</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      }</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      free(framePath);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   }</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;   <span class="keywordflow">if</span>(startFrameIndex){</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      free(startFrameIndex);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;   }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;   <span class="keywordflow">if</span>(skipFrameIndex){</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      free(skipFrameIndex);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;   }</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;   <span class="keywordflow">if</span>(paramsStartFrameIndex){</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      free(paramsStartFrameIndex);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   <span class="keywordflow">if</span>(paramsSkipFrameIndex){</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      free(paramsSkipFrameIndex);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;   }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   <span class="keywordflow">if</span>(batchMethod){</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      free(batchMethod);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   <span class="keywordflow">if</span>(batchPos){</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      free(batchPos);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;   }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;   <span class="keywordflow">if</span>(frameNumbers){</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      free(frameNumbers);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;}</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="keywordtype">int</span> Movie::initialize_base() {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;   movieOutputPath = NULL;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;   echoFramePathnameFlag = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;   filenamestream = NULL;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   displayPeriod = DISPLAY_PERIOD;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;   framePath = NULL;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;   numFrames = 0;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   frameNumbers = NULL;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;   writeFrameToTimestamp = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   timestampFile = NULL;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;   flipOnTimescaleError = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;   resetToStartOnLoop = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;   startFrameIndex = NULL;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;   skipFrameIndex = NULL;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;   paramsStartFrameIndex = NULL;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;   paramsSkipFrameIndex = NULL;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;   numStartFrame = 0;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;   numSkipFrame = 0;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;   batchPos = NULL;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;   batchMethod = NULL;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   <span class="comment">//randomMovie commented out Jul 22, 2015</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;   <span class="comment">//randomMovie = false;</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   <span class="comment">//updateThisTimestep = false;</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;   <span class="comment">// newImageFlag = false;</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;   initFlag = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;   <span class="keywordflow">return</span> PV_SUCCESS;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;}</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="keywordtype">int</span> Movie::readStateFromCheckpoint(<span class="keyword">const</span> <span class="keywordtype">char</span> * cpDir, <span class="keywordtype">double</span> * timeptr) {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   <span class="keywordtype">int</span> status = Image::readStateFromCheckpoint(cpDir, timeptr);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   status = readFrameNumStateFromCheckpoint(cpDir);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;   <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;}</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="keywordtype">int</span> Movie::readFrameNumStateFromCheckpoint(<span class="keyword">const</span> <span class="keywordtype">char</span> * cpDir) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   <span class="keywordtype">int</span> status = PV_SUCCESS;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;   <span class="keywordtype">int</span> nbatch = parent-&gt;getNBatch();</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;   parent-&gt;readArrayFromFile(cpDir, getName(), <span class="stringliteral">&quot;FilenamePos&quot;</span>, batchPos, nbatch);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;   parent-&gt;readArrayFromFile(cpDir, getName(), <span class="stringliteral">&quot;FrameNumbers&quot;</span>, frameNumbers, parent-&gt;getNBatch());</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   <span class="comment">//for(int b = 0; b &lt; nbatch; b++){</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   <span class="comment">//   int startFrame = frameNumber[b];</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   <span class="comment">//   if (parent-&gt;columnId()==0) {</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;   <span class="comment">//      PV_fseek(filenamestream, 0L, SEEK_SET);</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   <span class="comment">//      frameNumber = 0;</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   <span class="comment">//   }</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;   <span class="comment">//   if (framePath[b] != NULL) free(framePath[b]);</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   <span class="comment">//   //Navigates to one frame before, as getFrame will increment getNextFileName </span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;   <span class="comment">//   if(startFrame - skipFrameIndex[b] &gt; 0){</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   <span class="comment">//      framePath[b] = strdup(getNextFileName(startFrame-skipFrameIndex[b])); // getNextFileName() will increment frameNumber by startFrame;</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;   <span class="comment">//      initFlag = true;</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;   <span class="comment">//   }</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;   <span class="comment">//   if (parent-&gt;columnId()==0) assert(frameNumber[b]==startFrame);</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   <span class="comment">//   if (parent-&gt;columnId()==0) {</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;   <span class="comment">//      printf(&quot;%s \&quot;%s\&quot; checkpointRead set frameNumber to %d and filename to \&quot;%s\&quot;\n&quot;,</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;   <span class="comment">//            getKeyword(), name, frameNumber[b], framePath[b]);</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;   <span class="comment">//   }</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;   <span class="comment">//}</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;   <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;}</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div>
<div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="classPV_1_1Movie.html#ad5ec4ae16432ae42750256a5ec472e6a">  140</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classPV_1_1Movie.html#ad5ec4ae16432ae42750256a5ec472e6a">Movie::checkpointRead</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * cpDir, <span class="keywordtype">double</span> * timef){</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;   <span class="keywordtype">int</span> status = <a class="code" href="classPV_1_1BaseInput.html#a7b420ec4776779f5fc3ed9a92811f1e3">Image::checkpointRead</a>(cpDir, timef);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   <span class="comment">// should this be moved to readStateFromCheckpoint?</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   <span class="keywordflow">if</span> (writeFrameToTimestamp) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keywordtype">long</span> timestampFilePos = 0L;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      parent-&gt;readScalarFromFile(cpDir, getName(), <span class="stringliteral">&quot;TimestampState&quot;</span>, &amp;timestampFilePos, timestampFilePos);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="keywordflow">if</span> (timestampFile) {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;         assert(parent-&gt;columnId()==0);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;         <span class="keywordflow">if</span> (PV_fseek(timestampFile, timestampFilePos, SEEK_SET) != 0) {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            fprintf(stderr, <span class="stringliteral">&quot;MovieLayer::checkpointRead error: unable to recover initial file position in timestamp file for layer %s: %s\n&quot;</span>, name, strerror(errno));</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            exit(EXIT_FAILURE);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;         }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;}</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="keywordtype">int</span> Movie::checkpointWrite(<span class="keyword">const</span> <span class="keywordtype">char</span> * cpDir){</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   <span class="keywordtype">int</span> status = Image::checkpointWrite(cpDir);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;   parent-&gt;writeArrayToFile(cpDir, getName(), <span class="stringliteral">&quot;FilenamePos&quot;</span>, batchPos, parent-&gt;getNBatch());</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;   parent-&gt;writeArrayToFile(cpDir, getName(), <span class="stringliteral">&quot;FrameNumbers&quot;</span>, frameNumbers, parent-&gt;getNBatch());</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;   <span class="comment">//Only do a checkpoint TimestampState if there exists a timestamp file</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;   <span class="keywordflow">if</span> (timestampFile) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="keywordtype">long</span> timestampFilePos = getPV_StreamFilepos(timestampFile);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      parent-&gt;writeScalarToFile(cpDir, getName(), <span class="stringliteral">&quot;TimestampState&quot;</span>, timestampFilePos);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;   <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;}</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment"> * Notes:</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment"> * - writeImages, offsetX, offsetY are initialized by Image::initialize()</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="keywordtype">int</span> Movie::initialize(<span class="keyword">const</span> <span class="keywordtype">char</span> * name, HyPerCol * hc) { <span class="keywordtype">int</span> status = Image::initialize(name, hc);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;   <span class="keywordflow">if</span> (status != PV_SUCCESS) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;Image::initialize failed on Movie layer \&quot;%s\&quot;.  Exiting.\n&quot;</span>, name);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      exit(PV_FAILURE);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   <span class="comment">//Update on first timestep</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   <a class="code" href="classPV_1_1HyPerLayer.html#a70b5cd86852df8df6a7aa2ee13248ca0">setNextUpdateTime</a>(parent-&gt;simulationTime() + hc-&gt;getDeltaTime());</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;   PVParams * params = hc-&gt;parameters();</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;   <span class="comment">//assert(!params-&gt;presentAndNotBeenRead(name, &quot;randomMovie&quot;)); // randomMovie should have been set in ioParams</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;   <span class="comment">//if (randomMovie) return status; // Nothing else to be done until data buffer is allocated, in allocateDataStructures</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;   <span class="comment">//If not pvp file, open fileOfFileNames </span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;   <span class="comment">//assert(!params-&gt;presentAndNotBeenRead(name, &quot;readPvpFile&quot;)); // readPvpFile should have been set in ioParams</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;   <span class="keywordflow">if</span> (hc-&gt;columnId()==0) {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      filenamestream = PV_fopen(inputPath, <span class="stringliteral">&quot;r&quot;</span>, <span class="keyword">false</span><span class="comment">/*verifyWrites*/</span>);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keywordflow">if</span>( filenamestream == NULL ) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;         fprintf(stderr, <span class="stringliteral">&quot;Movie::initialize error opening \&quot;%s\&quot;: %s\n&quot;</span>, inputPath, strerror(errno));</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;         exit(EXIT_FAILURE);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;   }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;   <span class="comment">//if (!randomMovie) {</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;   <span class="comment">//   //frameNumber handled here</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;   <span class="comment">//   //imageFilename = strdup(getNextFileName(startFrameIndex));</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;   <span class="comment">//   //assert(imageFilename != NULL);</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;   <span class="comment">//}</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;   <span class="comment">// set output path for movie frames</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;   <span class="keywordflow">if</span>(writeImages){</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      status = parent-&gt;ensureDirExists(movieOutputPath);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;   }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;   <span class="keywordflow">if</span>(writeFrameToTimestamp){</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      std::string timestampFilename = std::string(parent-&gt;getOutputPath());</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      timestampFilename += <span class="stringliteral">&quot;/timestamps/&quot;</span>;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      parent-&gt;ensureDirExists(timestampFilename.c_str());</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      timestampFilename += name;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      timestampFilename += <span class="stringliteral">&quot;.txt&quot;</span>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="keywordflow">if</span>(getParent()-&gt;icCommunicator()-&gt;commRank()==0){</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;          <span class="comment">//If checkpoint read is set, append, otherwise, clobber</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;          <span class="keywordflow">if</span>(getParent()-&gt;getCheckpointReadFlag()){</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;             <span class="keyword">struct </span>stat statbuf;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;             <span class="keywordflow">if</span> (PV_stat(timestampFilename.c_str(), &amp;statbuf) != 0) {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                fprintf(stderr, <span class="stringliteral">&quot;%s \&quot;%s\&quot; warning: timestamp file \&quot;%s\&quot; unable to be found.  Creating new file.\n&quot;</span>,</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                      <a class="code" href="classPV_1_1HyPerLayer.html#af36deaaed17b033498dd60679dbebb25">getKeyword</a>(), name, timestampFilename.c_str());</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                timestampFile = PV::PV_fopen(timestampFilename.c_str(), <span class="stringliteral">&quot;w&quot;</span>, parent-&gt;<a class="code" href="classPV_1_1HyPerCol.html#a436bb917c4024424c8bde1bd0ef71fe3">getVerifyWrites</a>());</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;             }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;             <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                timestampFile = PV::PV_fopen(timestampFilename.c_str(), <span class="stringliteral">&quot;r+&quot;</span>, <span class="keyword">false</span><span class="comment">/*verifyWrites*/</span>);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;             }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;          }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;          <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;             timestampFile = PV::PV_fopen(timestampFilename.c_str(), <span class="stringliteral">&quot;w&quot;</span>, parent-&gt;<a class="code" href="classPV_1_1HyPerCol.html#a436bb917c4024424c8bde1bd0ef71fe3">getVerifyWrites</a>());</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;          }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;          assert(timestampFile);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;   }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;   <span class="keywordflow">return</span> PV_SUCCESS;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;}</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div>
<div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="classPV_1_1Movie.html#a0e11210c5169806856ebd9b25597befa">  245</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classPV_1_1Movie.html#a0e11210c5169806856ebd9b25597befa">Movie::ioParamsFillGroup</a>(<span class="keyword">enum</span> ParamsIOFlag ioFlag) {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   <span class="keywordtype">int</span> status = <a class="code" href="classPV_1_1Image.html#a8d1cc57a56a99c5e742803a669ee137b">Image::ioParamsFillGroup</a>(ioFlag);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;   <span class="comment">//ioParam_imageListPath(ioFlag);</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;   <a class="code" href="classPV_1_1Movie.html#a99c40879fd368921aa76cc12698323b7">ioParam_displayPeriod</a>(ioFlag);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   <span class="comment">//ioParam_randomMovie(ioFlag);</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;   <span class="comment">//ioParam_randomMovieProb(ioFlag);</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   <span class="comment">//ioParam_readPvpFile(ioFlag);</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;   <a class="code" href="classPV_1_1Movie.html#a9f2c811e5903bbe55137907a9e3052a9">ioParam_echoFramePathnameFlag</a>(ioFlag);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;   <a class="code" href="classPV_1_1Movie.html#afb154d4daab54203e1208828e2fab089">ioParam_batchMethod</a>(ioFlag);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;   <a class="code" href="classPV_1_1Movie.html#acf2039738a817b781d7515f9e8af46da">ioParam_start_frame_index</a>(ioFlag);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   <a class="code" href="classPV_1_1Movie.html#abbf7eeb308dd947092df41fb0277cb5f">ioParam_skip_frame_index</a>(ioFlag);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;   <a class="code" href="classPV_1_1Movie.html#a3c93227b2ed6fa4583679916d681432a">ioParam_movieOutputPath</a>(ioFlag);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;   <a class="code" href="classPV_1_1Movie.html#a30957bada05b3d7b85fd66bce0b5375b">ioParam_writeFrameToTimestamp</a>(ioFlag);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;   <a class="code" href="classPV_1_1Movie.html#ada08079aab340c4d4338962a9d77192f">ioParam_flipOnTimescaleError</a>(ioFlag);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;   <a class="code" href="classPV_1_1Movie.html#a7def03ad1189739a8f6c02f18d94ac00">ioParam_resetToStartOnLoop</a>(ioFlag);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;   <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;}</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">//void Movie::ioParam_imagePath(enum ParamsIOFlag ioFlag) {</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">//   if (ioFlag == PARAMS_IO_READ) {</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">//      imageFilename = NULL;</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">//      parent-&gt;parameters()-&gt;handleUnnecessaryStringParameter(name, &quot;imageList&quot;);</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">//   }</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">//void Movie::ioParam_frameNumber(enum ParamsIOFlag ioFlag) {</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">//   // Image uses frameNumber to pick the frame of a pvp file, but</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">//   // Movie uses start_frame_index to pick the starting frame.</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">//   if (ioFlag == PARAMS_IO_READ) {</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">//      filename = NULL;</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">//      parent-&gt;parameters()-&gt;handleUnnecessaryParameter(name, &quot;frameNumber&quot;);</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">//   }</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">//void Movie::ioParam_imageListPath(enum ParamsIOFlag ioFlag) {</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">//   parent-&gt;ioParamStringRequired(ioFlag, name, &quot;imageListPath&quot;, &amp;fileOfFileNames);</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div>
<div class="line"><a name="l00283"></a><span class="lineno"><a class="line" href="classPV_1_1Movie.html#ada08079aab340c4d4338962a9d77192f">  283</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classPV_1_1Movie.html#ada08079aab340c4d4338962a9d77192f">Movie::ioParam_flipOnTimescaleError</a>(<span class="keyword">enum</span> ParamsIOFlag ioFlag) {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;   parent-&gt;ioParamValue(ioFlag, name, <span class="stringliteral">&quot;flipOnTimescaleError&quot;</span>, &amp;flipOnTimescaleError, flipOnTimescaleError);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;}</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno"><a class="line" href="classPV_1_1Movie.html#a99c40879fd368921aa76cc12698323b7">  287</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classPV_1_1Movie.html#a99c40879fd368921aa76cc12698323b7">Movie::ioParam_displayPeriod</a>(<span class="keyword">enum</span> ParamsIOFlag ioFlag) {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;   parent-&gt;ioParamValue(ioFlag, name, <span class="stringliteral">&quot;displayPeriod&quot;</span>, &amp;displayPeriod, displayPeriod);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;}</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">//void Movie::ioParam_randomMovie(enum ParamsIOFlag ioFlag) {</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">//   parent-&gt;ioParamValue(ioFlag, name, &quot;randomMovie&quot;, &amp;randomMovie, 0/*default value*/);</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">//void Movie::ioParam_randomMovieProb(enum ParamsIOFlag ioFlag) {</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">//   assert(!parent-&gt;parameters()-&gt;presentAndNotBeenRead(name, &quot;randomMovie&quot;));</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">//   if (randomMovie) {</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">//      parent-&gt;ioParamValue(ioFlag, name, &quot;randomMovieProb&quot;, &amp;randomMovieProb, 0.05f);</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">//   }</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">//void Movie::ioParam_readPvpFile(enum ParamsIOFlag ioFlag) {</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">//   assert(!parent-&gt;parameters()-&gt;presentAndNotBeenRead(name, &quot;randomMovie&quot;));</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">//   if (!randomMovie) {</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">//      parent-&gt;ioParamValue(ioFlag, name, &quot;readPvpFile&quot;, &amp;readPvpFile, false/*default value*/);</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">//   }</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div>
<div class="line"><a name="l00309"></a><span class="lineno"><a class="line" href="classPV_1_1Movie.html#a9f2c811e5903bbe55137907a9e3052a9">  309</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classPV_1_1Movie.html#a9f2c811e5903bbe55137907a9e3052a9">Movie::ioParam_echoFramePathnameFlag</a>(<span class="keyword">enum</span> ParamsIOFlag ioFlag) {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;   <span class="comment">//assert(!parent-&gt;parameters()-&gt;presentAndNotBeenRead(name, &quot;randomMovie&quot;));</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;   <span class="comment">//if (!randomMovie) {</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      parent-&gt;ioParamValue(ioFlag, name, <span class="stringliteral">&quot;echoFramePathnameFlag&quot;</span>, &amp;echoFramePathnameFlag, <span class="keyword">false</span><span class="comment">/*default value*/</span>);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;   <span class="comment">//}</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;}</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div>
<div class="line"><a name="l00316"></a><span class="lineno"><a class="line" href="classPV_1_1Movie.html#afb154d4daab54203e1208828e2fab089">  316</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classPV_1_1Movie.html#afb154d4daab54203e1208828e2fab089">Movie::ioParam_batchMethod</a>(<span class="keyword">enum</span> ParamsIOFlag ioFlag){</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;   parent-&gt;ioParamString(ioFlag, name, <span class="stringliteral">&quot;batchMethod&quot;</span>, &amp;batchMethod, <span class="stringliteral">&quot;bySpecified&quot;</span>);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;   <span class="keywordflow">if</span>(strcmp(batchMethod, <span class="stringliteral">&quot;byImage&quot;</span>) == 0 || strcmp(batchMethod, <span class="stringliteral">&quot;byMovie&quot;</span>) == 0 || strcmp(batchMethod, <span class="stringliteral">&quot;bySpecified&quot;</span>) == 0){</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="comment">//Correct</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;   }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;   <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;Movie layer &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; batchMethod not recognized. Options are \&quot;byImage\&quot;, \&quot;byMovie\&quot;, and \&quot;bySpecified\&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      exit(-1);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;   }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;}</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div>
<div class="line"><a name="l00327"></a><span class="lineno"><a class="line" href="classPV_1_1Movie.html#acf2039738a817b781d7515f9e8af46da">  327</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classPV_1_1Movie.html#acf2039738a817b781d7515f9e8af46da">Movie::ioParam_start_frame_index</a>(<span class="keyword">enum</span> ParamsIOFlag ioFlag) {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;   <span class="comment">//Read parameter</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;   this-&gt;getParent()-&gt;ioParamArray(ioFlag, this-&gt;getName(), <span class="stringliteral">&quot;start_frame_index&quot;</span>, &amp;paramsStartFrameIndex, &amp;numStartFrame);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;   <span class="comment">//if(numStartFrame == 0){</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;   <span class="comment">//   numStartFrameIndex = 1;</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;   <span class="comment">//   *paramsStartFrameIndex = 0;</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;   <span class="comment">//}</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;}</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div>
<div class="line"><a name="l00336"></a><span class="lineno"><a class="line" href="classPV_1_1Movie.html#abbf7eeb308dd947092df41fb0277cb5f">  336</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classPV_1_1Movie.html#abbf7eeb308dd947092df41fb0277cb5f">Movie::ioParam_skip_frame_index</a>(<span class="keyword">enum</span> ParamsIOFlag ioFlag) {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;   <span class="comment">//Read parameter</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;   this-&gt;getParent()-&gt;ioParamArray(ioFlag, this-&gt;getName(), <span class="stringliteral">&quot;skip_frame_index&quot;</span>, &amp;paramsSkipFrameIndex, &amp;numSkipFrame);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   <span class="comment">//if(numSkipFrame == 0){</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;   <span class="comment">//   *paramsSkipFrameIndex = 1;</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;   <span class="comment">//}</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;}</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div>
<div class="line"><a name="l00344"></a><span class="lineno"><a class="line" href="classPV_1_1Movie.html#a3c93227b2ed6fa4583679916d681432a">  344</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classPV_1_1Movie.html#a3c93227b2ed6fa4583679916d681432a">Movie::ioParam_movieOutputPath</a>(<span class="keyword">enum</span> ParamsIOFlag ioFlag) {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;   assert(!parent-&gt;parameters()-&gt;presentAndNotBeenRead(name, <span class="stringliteral">&quot;writeImages&quot;</span>));</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;   <span class="keywordflow">if</span> (writeImages){</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      parent-&gt;ioParamString(ioFlag, name, <span class="stringliteral">&quot;movieOutputPath&quot;</span>, &amp;movieOutputPath, parent-&gt;getOutputPath());</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;   }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;}</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div>
<div class="line"><a name="l00351"></a><span class="lineno"><a class="line" href="classPV_1_1Movie.html#a30957bada05b3d7b85fd66bce0b5375b">  351</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classPV_1_1Movie.html#a30957bada05b3d7b85fd66bce0b5375b">Movie::ioParam_writeFrameToTimestamp</a>(<span class="keyword">enum</span> ParamsIOFlag ioFlag) {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;   parent-&gt;ioParamValue(ioFlag, name, <span class="stringliteral">&quot;writeFrameToTimestamp&quot;</span>, &amp;writeFrameToTimestamp, writeFrameToTimestamp);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;}</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div>
<div class="line"><a name="l00355"></a><span class="lineno"><a class="line" href="classPV_1_1Movie.html#a7def03ad1189739a8f6c02f18d94ac00">  355</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classPV_1_1Movie.html#a7def03ad1189739a8f6c02f18d94ac00">Movie::ioParam_resetToStartOnLoop</a>(<span class="keyword">enum</span> ParamsIOFlag ioFlag) {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;   parent-&gt;ioParamValue(ioFlag, name, <span class="stringliteral">&quot;resetToStartOnLoop&quot;</span>, &amp;resetToStartOnLoop, resetToStartOnLoop);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;}</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="keywordtype">int</span> Movie::allocateDataStructures() {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;   <span class="comment">//Allocate framePaths here before image, since allocate call will call getFrame</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;   <span class="keywordflow">if</span>(parent-&gt;icCommunicator()-&gt;commRank()==0){</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      framePath = (<span class="keywordtype">char</span>**) malloc(parent-&gt;getNBatch() * <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*));</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      assert(framePath);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b = 0; b &lt; parent-&gt;getNBatch(); b++){</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;         framePath[b] = NULL;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      }</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;   }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;   </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;   batchPos = (<span class="keywordtype">long</span>*) malloc(parent-&gt;getNBatch() * <span class="keyword">sizeof</span>(long));</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   <span class="keywordflow">if</span>(batchPos==NULL) {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;%s \&quot;%s\&quot; error allocating memory for batchPos (batch size %d): %s\n&quot;</span>,</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            name, <a class="code" href="classPV_1_1HyPerLayer.html#af36deaaed17b033498dd60679dbebb25">getKeyword</a>(), parent-&gt;getNBatch(), strerror(errno));</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      exit(EXIT_FAILURE);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;   }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b = 0; b &lt; parent-&gt;getNBatch(); b++){</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      batchPos[b] = 0L;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;   frameNumbers = (<span class="keywordtype">int</span>*) calloc(parent-&gt;getNBatch(), <span class="keyword">sizeof</span>(int));</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;   <span class="keywordflow">if</span> (frameNumbers==NULL) {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      fprintf(stderr, <span class="stringliteral">&quot;%s \&quot;%s\&quot; error allocating memory for frameNumbers (batch size %d): %s\n&quot;</span>,</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            name, <a class="code" href="classPV_1_1HyPerLayer.html#af36deaaed17b033498dd60679dbebb25">getKeyword</a>(), parent-&gt;getNBatch(), strerror(errno));</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      exit(EXIT_FAILURE);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;   }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;   <span class="comment">//Calculate file positions for beginning of each frame</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;   numFrames = getNumFrames();</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;   std::cout &lt;&lt; <span class="stringliteral">&quot;File &quot;</span> &lt;&lt; inputPath &lt;&lt; <span class="stringliteral">&quot; contains &quot;</span> &lt;&lt; numFrames &lt;&lt; <span class="stringliteral">&quot; frames\n&quot;</span>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;   startFrameIndex = (<span class="keywordtype">int</span>*)calloc(parent-&gt;getNBatch(), <span class="keyword">sizeof</span>(int));</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;   assert(startFrameIndex);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;   skipFrameIndex = (<span class="keywordtype">int</span>*)calloc(parent-&gt;getNBatch(), <span class="keyword">sizeof</span>(int));</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;   assert(skipFrameIndex);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;   <span class="keywordtype">int</span> nbatch = parent-&gt;getNBatch();</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   assert(batchMethod);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;   <span class="keywordflow">if</span>(strcmp(batchMethod, <span class="stringliteral">&quot;byImage&quot;</span>) == 0){</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="comment">//No skip here allowed</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="keywordflow">if</span>(numSkipFrame != 0){</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;         std::cout &lt;&lt; <span class="stringliteral">&quot;Movie layer &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; batchMethod of \&quot;byImage\&quot; sets skip_frame_index, do not specify.\n&quot;</span>; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;         exit(-1);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <span class="keywordtype">int</span> offset = 0;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="comment">//Default value</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <span class="keywordflow">if</span>(numStartFrame == 0){</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <span class="comment">//Uniform start array</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(numStartFrame == 1){</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;         offset = *paramsStartFrameIndex;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      }</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;         std::cout &lt;&lt; <span class="stringliteral">&quot;Movie layer &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; batchMethod of \&quot;byImage\&quot; requires 0 or 1 start_frame_index values\n&quot;</span>; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;         exit(-1);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="comment">//Allocate and default</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <span class="comment">//Not done in allocate, as Image Allocate needs this parameter to be set</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <span class="keywordtype">int</span> kb0 = getLayerLoc()-&gt;kb0;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <span class="keywordtype">int</span> nbatchGlobal = getLayerLoc()-&gt;nbatchGlobal;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b = 0; b &lt; nbatch; b++){ </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;         startFrameIndex[b] = offset + kb0 + b;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;         skipFrameIndex[b] = nbatchGlobal;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;   }</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(batchMethod, <span class="stringliteral">&quot;byMovie&quot;</span>) == 0){</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="comment">//No skip here allowed</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="keywordflow">if</span>(numSkipFrame != 0){</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;         std::cout &lt;&lt; <span class="stringliteral">&quot;Movie layer &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; batchMethod of \&quot;byImage\&quot; sets skip_frame_index, do not specify.\n&quot;</span>; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;         exit(-1);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <span class="keywordtype">int</span> offset = 0;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <span class="comment">//Default value</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <span class="keywordflow">if</span>(numStartFrame== 0){</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <span class="comment">//Uniform start array</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(numStartFrame== 1){</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;         offset = *paramsStartFrameIndex;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      }</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;         std::cout &lt;&lt; <span class="stringliteral">&quot;Movie layer &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; batchMethod of \&quot;byMovie\&quot; requires 0 or 1 start_frame_index values\n&quot;</span>; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;         exit(-1);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      <span class="keywordtype">int</span> nbatchGlobal = getLayerLoc()-&gt;nbatchGlobal;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <span class="keywordtype">int</span> kb0 = getLayerLoc()-&gt;kb0;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <span class="keywordtype">int</span> framesPerBatch = floor(numFrames/nbatchGlobal);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <span class="keywordflow">if</span>(framesPerBatch &lt; 1){</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;         framesPerBatch = 1;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b = 0; b &lt; nbatch; b++){ </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;         <span class="comment">//+1 for 1 indexed</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;         startFrameIndex[b] = offset + ((b+kb0)*framesPerBatch);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;         skipFrameIndex[b] = 1;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;   }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(batchMethod, <span class="stringliteral">&quot;bySpecified&quot;</span>) == 0){</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <span class="keywordflow">if</span>(numStartFrame != nbatch &amp;&amp; numStartFrame != 0){</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;         std::cout &lt;&lt; <span class="stringliteral">&quot;Movie layer &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; batchMethod of \&quot;bySpecified\&quot; requires &quot;</span> &lt;&lt; nbatch &lt;&lt; <span class="stringliteral">&quot; start_frame_index values\n&quot;</span>; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;         exit(-1);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      }</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <span class="keywordflow">if</span>(numSkipFrame != nbatch &amp;&amp; numSkipFrame != 0){</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;         std::cout &lt;&lt; <span class="stringliteral">&quot;Movie layer &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; batchMethod of \&quot;bySpecified\&quot; requires &quot;</span> &lt;&lt; nbatch &lt;&lt; <span class="stringliteral">&quot; skip_frame_index values\n&quot;</span>; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;         exit(-1);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b = 0; b &lt; nbatch; b++){ </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;         <span class="keywordflow">if</span>(numStartFrame == 0){</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <span class="comment">//+1 for 1 indexed</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            startFrameIndex[b] = 0;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;         }</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;         <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            startFrameIndex[b] = paramsStartFrameIndex[b];</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;         }</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;         <span class="keywordflow">if</span>(numSkipFrame == 0){</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            skipFrameIndex[b] = 1;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;         }</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;         <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            skipFrameIndex[b] = paramsSkipFrameIndex[b];</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;         }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      }</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;   }</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;   <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <span class="comment">//This should never excute, as this check was done in the reading of this parameter</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      assert(0);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;   }</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;   <span class="keywordflow">if</span> (parent-&gt;columnId()==0) {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b=0; b&lt;parent-&gt;getNBatch(); b++) {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;         frameNumbers[b] = -1;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;   }</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;   <span class="comment">//Call Image allocate, which will call getFrame</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;   <span class="keywordtype">int</span> status = Image::allocateDataStructures();</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;   <span class="comment">//if (!randomMovie) {</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      <span class="comment">//assert(!parent-&gt;parameters()-&gt;presentAndNotBeenRead(name, &quot;start_frame_index&quot;));</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      <span class="comment">//assert(!parent-&gt;parameters()-&gt;presentAndNotBeenRead(name, &quot;skip_frame_index&quot;));</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <span class="comment">//assert(!parent-&gt;parameters()-&gt;presentAndNotBeenRead(name, &quot;autoResizeFlag&quot;));</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <span class="comment">//if (!autoResizeFlag){</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <span class="comment">//   constrainOffsets();  // ensure that offsets keep loc within image bounds</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <span class="comment">//}</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      <span class="comment">// status = readImage(filename, getOffsetX(), getOffsetY()); // readImage already called by Image::allocateDataStructures(), above</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <span class="comment">//assert(status == PV_SUCCESS);</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;   <span class="comment">//}</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;   <span class="comment">//else {</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;   <span class="comment">//   if (randState==NULL) {</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;   <span class="comment">//      initRandState();</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   <span class="comment">//   }</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;   <span class="comment">//   status = randomFrame();</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;   <span class="comment">//}</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;}</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;pvdata_t * Movie::getImageBuffer()</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;{</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;   <span class="comment">//   return imageData;</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;   <span class="keywordflow">return</span> data;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;}</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<a class="code" href="structPVLayerLoc__.html">PVLayerLoc</a> Movie::getImageLoc()</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;{</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;   <span class="keywordflow">return</span> imageLoc;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;   <span class="comment">//   return clayer-&gt;loc;</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;   <span class="comment">// imageLoc contains size information of the image file being loaded;</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;   <span class="comment">// clayer-&gt;loc contains size information of the layer, which may</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;   <span class="comment">// be smaller than the whole image.  To get information on the layer, use</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;   <span class="comment">// getLayerLoc().  --pete 2011-07-10</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;}</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div>
<div class="line"><a name="l00537"></a><span class="lineno"><a class="line" href="classPV_1_1Movie.html#ac3e3d39db3b527d2ea5dcb8b3c0e97d5">  537</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classPV_1_1Movie.html#ac3e3d39db3b527d2ea5dcb8b3c0e97d5">Movie::getDeltaUpdateTime</a>(){</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;   <span class="comment">//If jitter or randomMovie, update every timestep</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;   <span class="keywordflow">if</span>( jitterFlag ){</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      <span class="keywordflow">return</span> parent-&gt;getDeltaTime();</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;   }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;   <span class="comment">//if(randomMovie){</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;   <span class="comment">//   return parent-&gt;getDeltaTime();</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;   <span class="comment">//}</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;   <span class="keywordflow">return</span> displayPeriod;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;}</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="comment">// ensure that timeScale == 1 if new frame being loaded on current time step</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="comment">// (note: this used to add getDeltaTime to simulationTime, but calcTimeScale is now called after simulationTime is incremented. -pfs 2015-11-05)</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="keywordtype">double</span> Movie::calcTimeScale(<span class="keywordtype">int</span> batchIdx){</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classPV_1_1HyPerLayer.html#a33a6e33be986fdc9ea02471e48e7a158">needUpdate</a>(parent-&gt;simulationTime(), parent-&gt;getDeltaTime())){</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      <span class="keywordflow">return</span> parent-&gt;getTimeScaleMin(); </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    }</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      <span class="keywordflow">return</span> HyPerLayer::calcTimeScale(batchIdx);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  }</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div>
<div class="line"><a name="l00560"></a><span class="lineno"><a class="line" href="classPV_1_1Movie.html#a13b6296402925e1447d40a732416e5f0">  560</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classPV_1_1Movie.html#a13b6296402925e1447d40a732416e5f0">Movie::updateState</a>(<span class="keywordtype">double</span> time, <span class="keywordtype">double</span> dt)</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;{</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;   <a class="code" href="classPV_1_1Movie.html#a0a265671ba1f88eb85c9f35df320a043">updateImage</a>(time, dt);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;   <span class="keywordflow">return</span> PV_SUCCESS;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;}</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">//Image readImage reads the same thing to every batch</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">//This call is here since this is the entry point called from allocate</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">//Movie overwrites this function to define how it wants to load into batches</span></div>
<div class="line"><a name="l00570"></a><span class="lineno"><a class="line" href="classPV_1_1Movie.html#a4dd7fd5e516257b38ff600d081f394bd">  570</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classPV_1_1Movie.html#a4dd7fd5e516257b38ff600d081f394bd">Movie::retrieveData</a>(<span class="keywordtype">double</span> timef, <span class="keywordtype">double</span> dt)</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;{</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;   <span class="keywordtype">int</span> status = PV_SUCCESS;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;   <span class="keywordtype">bool</span> init = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b = 0; b &lt; parent-&gt;getNBatch(); b++){</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      <span class="keywordflow">if</span>(parent-&gt;icCommunicator()-&gt;commRank() == 0){</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;         <span class="keywordflow">if</span>(framePath[b]!= NULL) free(framePath[b]);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;         <span class="keywordflow">if</span>(!initFlag){</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            framePath[b] = strdup(<a class="code" href="classPV_1_1Movie.html#a12a59e47aa11ce3fd1d8371aeb32ffb9">getNextFileName</a>(startFrameIndex[b]+1, b));</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            init = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;         }</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;         <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            framePath[b] = strdup(<a class="code" href="classPV_1_1Movie.html#a12a59e47aa11ce3fd1d8371aeb32ffb9">getNextFileName</a>(skipFrameIndex[b], b));</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;         }</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;         std::cout &lt;&lt; <span class="stringliteral">&quot;Reading frame &quot;</span> &lt;&lt; framePath[b] &lt;&lt; <span class="stringliteral">&quot; into batch &quot;</span> &lt;&lt; b &lt;&lt; <span class="stringliteral">&quot; at time &quot;</span> &lt;&lt; timef &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;         status = readImage(framePath[b], b, offsets[0], offsets[1], offsetAnchor);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;         status = readImage(NULL, b, offsets[0], offsets[1], offsetAnchor);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      }</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      <span class="keywordflow">if</span>( status != PV_SUCCESS ) {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;         fprintf(stderr, <span class="stringliteral">&quot;Movie %s: Error reading file \&quot;%s\&quot;\n&quot;</span>, name, framePath[b]);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;         abort();</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      }</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;   }</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;   <span class="keywordflow">if</span>(init){</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      initFlag = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;   }</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;   <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;}</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div>
<div class="line"><a name="l00614"></a><span class="lineno"><a class="line" href="classPV_1_1Movie.html#a0a265671ba1f88eb85c9f35df320a043">  614</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classPV_1_1Movie.html#a0a265671ba1f88eb85c9f35df320a043">Movie::updateImage</a>(<span class="keywordtype">double</span> time, <span class="keywordtype">double</span> dt)</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;{</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;   <span class="keywordflow">if</span>( jitterFlag ) {</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      jitter();</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;   } <span class="comment">// jitterFlag</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;   <a class="code" href="classPV_1_1InterColComm.html">InterColComm</a> * icComm = getParent()-&gt;icCommunicator();</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <span class="comment">//TODO: Fix movie layer to take with batches. This is commented out for compile</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      <span class="comment">//if(!flipOnTimescaleError &amp;&amp; (parent-&gt;getTimeScale() &gt; 0 &amp;&amp; parent-&gt;getTimeScale() &lt; parent-&gt;getTimeScaleMin())){</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      <span class="comment">//   if (parent-&gt;icCommunicator()-&gt;commRank()==0) {</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      <span class="comment">//      std::cout &lt;&lt; &quot;timeScale of &quot; &lt;&lt; parent-&gt;getTimeScale() &lt;&lt; &quot; is less than timeScaleMin of &quot; &lt;&lt; parent-&gt;getTimeScaleMin() &lt;&lt; &quot;, Movie is keeping the same frame\n&quot;;</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      <span class="comment">//   }</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <span class="comment">//}</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      <span class="comment">//else{</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;         <span class="comment">//Only do this if it&#39;s not the first update timestep</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;         <span class="comment">//The timestep number is (time - startTime)/(width of timestep), with allowance for roundoff.</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;         <span class="comment">//But if we&#39;re using adaptive timesteps, the dt passed as a function argument is not the correct (width of timestep).  </span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      <span class="keywordflow">if</span>(fabs(time - (parent-&gt;getStartTime() + parent-&gt;getDeltaTime())) &gt; (parent-&gt;getDeltaTime()/2)){</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;         <span class="keywordtype">int</span> status = <a class="code" href="classPV_1_1BaseInput.html#a9de070e226b4a755130ba50fd2fb606f">getFrame</a>(time, dt);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;         assert(status == PV_SUCCESS);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      }</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      <span class="comment">//nextDisplayTime removed, now using nextUpdateTime in HyPerLayer</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      <span class="comment">//while (time &gt;= nextDisplayTime) {</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      <span class="comment">//   nextDisplayTime += displayPeriod;</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      <span class="comment">//}</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      <span class="comment">//Set frame number (member variable in Image)</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      <span class="comment">//Write to timestamp file here when updated</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      <span class="keywordflow">if</span>( icComm-&gt;commRank()==0 ) {</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;          <span class="comment">//Only write if the parameter is set</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;          <span class="keywordflow">if</span>(timestampFile){</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;             std::ostringstream outStrStream;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;             outStrStream.precision(15);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;             <span class="keywordtype">int</span> kb0 = getLayerLoc()-&gt;kb0;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b = 0; b &lt; parent-&gt;getNBatch(); b++){</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                outStrStream &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; b+kb0 &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; frameNumbers[b] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; framePath[b] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;             }</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;             <span class="keywordtype">size_t</span> len = outStrStream.str().length();</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;             <span class="keywordtype">int</span> status = <a class="code" href="namespacePV.html#adb616cc87488824fc1d4bf93fea0814b">PV_fwrite</a>(outStrStream.str().c_str(), <span class="keyword">sizeof</span>(char), len, timestampFile)==len ? PV_SUCCESS : PV_FAILURE;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;             <span class="keywordflow">if</span> (status != PV_SUCCESS) {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                fprintf(stderr, <span class="stringliteral">&quot;%s \&quot;%s\&quot; error: Movie::updateState failed to write to timestamp file.\n&quot;</span>, <a class="code" href="classPV_1_1HyPerLayer.html#af36deaaed17b033498dd60679dbebb25">getKeyword</a>(), name);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                exit(EXIT_FAILURE);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;             }</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;             <span class="comment">//Flush buffer</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;             fflush(timestampFile-&gt;fp);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;          }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      }</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;   <span class="comment">//} // randomMovie</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;   <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;}</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div>
<div class="line"><a name="l00677"></a><span class="lineno"><a class="line" href="classPV_1_1Movie.html#a4999705acea89ca9bcb729253fe095a0">  677</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classPV_1_1Movie.html#a4999705acea89ca9bcb729253fe095a0">Movie::outputState</a>(<span class="keywordtype">double</span> timed, <span class="keywordtype">bool</span> last)</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;{</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;   <span class="keywordflow">if</span> (writeImages) {</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      <span class="keywordtype">char</span> basicFilename[PV_PATH_MAX + 1];</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b = 0; b &lt; parent-&gt;getNBatch(); b++){</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;         snprintf(basicFilename, PV_PATH_MAX, <span class="stringliteral">&quot;%s/%s_%d_%.2f.%s&quot;</span>, movieOutputPath, name, b, timed, writeImagesExtension);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;         <a class="code" href="classPV_1_1BaseInput.html#a5287d7e1488696f3d8ecbaf2d9465597">writeImage</a>(basicFilename, b);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      }</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;   }</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;   <span class="keywordtype">int</span> status = PV_SUCCESS;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;   status = HyPerLayer::outputState(timed, last);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;   <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;}</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">//int Movie::copyReducedImagePortion()</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">//{</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">//   const PVLayerLoc * loc = getLayerLoc();</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">//   const int nx = loc-&gt;nx;</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">//   const int ny = loc-&gt;ny;</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">//   const int nx0 = imageLoc.nx;</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">//   const int ny0 = imageLoc.ny;</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">//   assert(nx0 &lt;= nx);</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">//   assert(ny0 &lt;= ny);</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">//   const int i0 = nx/2 - nx0/2;</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">//   const int j0 = ny/2 - ny0/2;</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">//   int ii = 0;</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">//   for (int j = j0; j &lt; j0+ny0; j++) {</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment">//      for (int i = i0; i &lt; i0+nx0; i++) {</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">//         imageData[ii++] = data[i+nx*j];</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment">//      }</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">//   }</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">//   return 0;</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">// * This creates a random image patch (frame) that is used to perform a reverse correlation analysis</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">// * as the input signal propagates up the visual system&#39;s hierarchy.</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">// * NOTE: Check Image::toGrayScale() method which was the inspiration for this routine</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">// */</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment">//int Movie::randomFrame()</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">//{</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">//   assert(randomMovie); // randomMovieProb was set only if randomMovie is true</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">//   for (int kex = 0; kex &lt; clayer-&gt;numExtended; kex++) {</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">//      double p = randState-&gt;uniformRandom();</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">//      data[kex] = (p &lt; randomMovieProb) ? 1: 0;</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">//   }</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment">//   return 0;</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment">// * A function only called if readPvpFile is set</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">// * Will update frameNumber</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment">// */</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment"></span><span class="comment">//int Movie::updateFrameNum(int n_skip){</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment">//   //assert(readPvpFile);</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment">//   InterColComm * icComm = getParent()-&gt;icCommunicator();</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment">//   int numskip = n_skip &lt; 1 ? 1 : n_skip;</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">//   for(int i_skip = 0; i_skip &lt; numskip; i_skip++){</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment">//      int status = updateFrameNum();</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">//      if(status == PV_BREAK){</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">//         break;</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">//      }</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment">//   }</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">//   return PV_SUCCESS;</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment">//int Movie::updateFrameNum() {</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment">//   frameNumber += 1;</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment">//   //numFrames only set if pvp file</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment">//   if(frameNumber &gt;= numFrames){</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment">//      if(parent-&gt;columnId()==0){</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment">//         fprintf(stderr, &quot;Movie %s: EOF reached, rewinding file \&quot;%s\&quot;\n&quot;, name, fileOfFileNames);</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment">//      }</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">//      if(resetToStartOnLoop){</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">//         frameNumber = startFrameIndex-1;</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">//         return PV_BREAK;</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment">//      }</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment">//      else{</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment">//         frameNumber = 0;</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment">//      }</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment">//   }</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment">//   return PV_SUCCESS;</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment">// advance by n_skip lines through file of filenames, always advancing at least one line</span></div>
<div class="line"><a name="l00771"></a><span class="lineno"><a class="line" href="classPV_1_1Movie.html#a12a59e47aa11ce3fd1d8371aeb32ffb9">  771</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="classPV_1_1Movie.html#a12a59e47aa11ce3fd1d8371aeb32ffb9">Movie::getNextFileName</a>(<span class="keywordtype">int</span> n_skip, <span class="keywordtype">int</span> batchIdx) {</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;   <a class="code" href="classPV_1_1InterColComm.html">InterColComm</a> * icComm = getParent()-&gt;icCommunicator();</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;   assert(icComm-&gt;commRank() == 0);</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span>* outFilename = NULL;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;   <span class="keywordtype">int</span> numskip = n_skip &lt; 1 ? 1 : n_skip;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_skip = 0; i_skip &lt; numskip; i_skip++){</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      outFilename = advanceFileName(batchIdx);</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;   }</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;   <span class="keywordflow">if</span> (echoFramePathnameFlag){</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      printf(<span class="stringliteral">&quot;%f, %d: %s\n&quot;</span>, parent-&gt;simulationTime(), batchIdx, outFilename);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;   }</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;   <span class="keywordflow">return</span> outFilename;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;}</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment">//This function will reset the file position of the open file</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="keywordtype">int</span> Movie::getNumFrames(){</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;   <span class="keywordtype">int</span> count = 0;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;   <span class="keywordflow">if</span>(parent-&gt;columnId()==0){</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      <span class="keywordtype">int</span> c;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      PV_fseek(filenamestream, 0L, SEEK_SET);</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      <span class="keywordflow">while</span>((c = fgetc(filenamestream-&gt;fp)) != EOF) {</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;         count++;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;         ungetc(c, filenamestream-&gt;fp);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;         <span class="comment">//Here, we&#39;re using batch 0, but we&#39;re resetting the batch pos of it at the end</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;         advanceFileName(0);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      }</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      PV_fseek(filenamestream, 0L, SEEK_SET);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      batchPos[0] = 0L;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      frameNumbers[0] = -1;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;   }</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;   MPI_Bcast(&amp;count, 1, MPI_INT, 0, parent-&gt;icCommunicator()-&gt;communicator());</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;   <span class="keywordflow">return</span> count;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;}</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment">//This function takes care of rewinding for frame files</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> * Movie::advanceFileName(<span class="keywordtype">int</span> batchIdx) {</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;   <span class="comment">// IMPORTANT!! This function should only be called by getNextFileName(int), and only by the root process</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;   assert(parent-&gt;columnId()==0);</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;   <span class="comment">//Restore position of batch Idx</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;   PV_fseek(filenamestream, batchPos[batchIdx], SEEK_SET);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;   <span class="keywordtype">int</span> c;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;   <span class="keywordtype">size_t</span> maxlen = PV_PATH_MAX;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;   <span class="keywordtype">bool</span> reset = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;   <span class="comment">// Ignore blank lines</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;   <span class="keywordtype">bool</span> hasrewound = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;   <span class="keywordtype">bool</span> lineisblank = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;   <span class="keywordflow">while</span>(lineisblank) {</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      <span class="comment">// if at end of file (EOF), rewind</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      <span class="keywordflow">if</span> ((c = fgetc(filenamestream-&gt;fp)) == EOF) {</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;         PV_fseek(filenamestream, 0L, SEEK_SET);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;         frameNumbers[0] = -1;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;         fprintf(stderr, <span class="stringliteral">&quot;Movie %s: EOF reached, rewinding file \&quot;%s\&quot;\n&quot;</span>, name, inputPath);</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;         <span class="keywordflow">if</span> (hasrewound) {</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            fprintf(stderr, <span class="stringliteral">&quot;Movie %s: filenamestream \&quot;%s\&quot; does not have any non-blank lines.\n&quot;</span>, name, filenamestream-&gt;name);</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            exit(EXIT_FAILURE);</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;         }</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;         hasrewound = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;         reset = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      }</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;         ungetc(c, filenamestream-&gt;fp);</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      }</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      <span class="comment">//Always do at least once</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      <span class="keywordtype">int</span> loopCount = 0;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      <span class="keywordflow">do</span>{</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;         <span class="keywordtype">char</span> * path = fgets(inputfile, maxlen, filenamestream-&gt;fp);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;         <span class="keywordflow">if</span> (path != NULL) {</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            filenamestream-&gt;filepos += strlen(path);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;            path[PV_PATH_MAX-1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            <span class="keywordtype">size_t</span> len = strlen(path);</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            <span class="keywordflow">if</span> (len &gt; 0) {</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;               <span class="keywordflow">if</span> (path[len-1] == <span class="charliteral">&#39;\n&#39;</span>) {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                  path[len-1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                  len--;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;               }</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            }</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> n=0; n&lt;len; n++) {</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;               <span class="keywordflow">if</span> (!isblank(path[n])) {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                  frameNumbers[batchIdx]++;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                  lineisblank = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                  <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;               }</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            }</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            loopCount++;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;         }</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      }<span class="keywordflow">while</span>(resetToStartOnLoop &amp;&amp; reset &amp;&amp; loopCount &lt; startFrameIndex[batchIdx]);</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      assert(strlen(inputfile)&gt;(<span class="keywordtype">size_t</span>) 0);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      <span class="comment">// assert(inputfile &amp;&amp; strlen(inputfile)&gt;(size_t) 0);</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      <span class="comment">// current version of clang generates a warning since inputfile is a member variable declared as an array and therefore always non-null.</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      <span class="comment">// Keeping the line in case inputfile is changed to be malloc&#39;d instead of declared as an array.</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      <span class="keywordtype">char</span> * expandedpath = expandLeadingTilde(inputfile);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      <span class="keywordflow">if</span> (strlen(expandedpath)&gt;=PV_PATH_MAX) {</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;         fprintf(stderr, <span class="stringliteral">&quot;Movie \&quot;%s\&quot;: input line \&quot;%s\&quot; from imageListPath is too long.\n&quot;</span>, name, expandedpath);</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;         exit(EXIT_FAILURE);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      }</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      strncpy(inputfile, expandedpath, PV_PATH_MAX);</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      free(expandedpath);</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;   }</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;   <span class="comment">//Save batch position</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;   batchPos[batchIdx] = getPV_StreamFilepos(filenamestream);</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;   <span class="keywordflow">return</span> inputfile;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;}</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">//const char * Movie::getCurrentImage(){</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment">//   return inputfile;</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">//}</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;}</div>
<div class="ttc" id="classPV_1_1Movie_html_a9f2c811e5903bbe55137907a9e3052a9"><div class="ttname"><a href="classPV_1_1Movie.html#a9f2c811e5903bbe55137907a9e3052a9">PV::Movie::ioParam_echoFramePathnameFlag</a></div><div class="ttdeci">virtual void ioParam_echoFramePathnameFlag(enum ParamsIOFlag ioFlag)</div><div class="ttdoc">echoFramePathnameFlag: if true, print the filename to the screen when a new image file is loaded...</div><div class="ttdef"><b>Definition:</b> <a href="Movie_8cpp_source.html#l00309">Movie.cpp:309</a></div></div>
<div class="ttc" id="classPV_1_1Movie_html_a13b6296402925e1447d40a732416e5f0"><div class="ttname"><a href="classPV_1_1Movie.html#a13b6296402925e1447d40a732416e5f0">PV::Movie::updateState</a></div><div class="ttdeci">virtual int updateState(double time, double dt)</div><div class="ttdef"><b>Definition:</b> <a href="Movie_8cpp_source.html#l00560">Movie.cpp:560</a></div></div>
<div class="ttc" id="classPV_1_1Movie_html_afb154d4daab54203e1208828e2fab089"><div class="ttname"><a href="classPV_1_1Movie.html#afb154d4daab54203e1208828e2fab089">PV::Movie::ioParam_batchMethod</a></div><div class="ttdeci">virtual void ioParam_batchMethod(enum ParamsIOFlag ioFlag)</div><div class="ttdoc">batchMethod: Specifies how to split the file for batches. byImage: Each batch skips nbatch...</div><div class="ttdef"><b>Definition:</b> <a href="Movie_8cpp_source.html#l00316">Movie.cpp:316</a></div></div>
<div class="ttc" id="classPV_1_1HyPerLayer_html_af36deaaed17b033498dd60679dbebb25"><div class="ttname"><a href="classPV_1_1HyPerLayer.html#af36deaaed17b033498dd60679dbebb25">PV::HyPerLayer::getKeyword</a></div><div class="ttdeci">char const * getKeyword()</div><div class="ttdef"><b>Definition:</b> <a href="HyPerLayer_8cpp_source.html#l00295">HyPerLayer.cpp:295</a></div></div>
<div class="ttc" id="classPV_1_1Movie_html_ad5ec4ae16432ae42750256a5ec472e6a"><div class="ttname"><a href="classPV_1_1Movie.html#ad5ec4ae16432ae42750256a5ec472e6a">PV::Movie::checkpointRead</a></div><div class="ttdeci">virtual int checkpointRead(const char *cpDir, double *timef)</div><div class="ttdef"><b>Definition:</b> <a href="Movie_8cpp_source.html#l00140">Movie.cpp:140</a></div></div>
<div class="ttc" id="classPV_1_1Movie_html_a0a265671ba1f88eb85c9f35df320a043"><div class="ttname"><a href="classPV_1_1Movie.html#a0a265671ba1f88eb85c9f35df320a043">PV::Movie::updateImage</a></div><div class="ttdeci">virtual bool updateImage(double time, double dt)</div><div class="ttdef"><b>Definition:</b> <a href="Movie_8cpp_source.html#l00614">Movie.cpp:614</a></div></div>
<div class="ttc" id="classPV_1_1InterColComm_html"><div class="ttname"><a href="classPV_1_1InterColComm.html">PV::InterColComm</a></div><div class="ttdef"><b>Definition:</b> <a href="InterColComm_8hpp_source.html#l00091">InterColComm.hpp:91</a></div></div>
<div class="ttc" id="classPV_1_1Movie_html_a12a59e47aa11ce3fd1d8371aeb32ffb9"><div class="ttname"><a href="classPV_1_1Movie.html#a12a59e47aa11ce3fd1d8371aeb32ffb9">PV::Movie::getNextFileName</a></div><div class="ttdeci">const char * getNextFileName(int n_skip, int batchIdx)</div><div class="ttdef"><b>Definition:</b> <a href="Movie_8cpp_source.html#l00771">Movie.cpp:771</a></div></div>
<div class="ttc" id="classPV_1_1Movie_html_ada08079aab340c4d4338962a9d77192f"><div class="ttname"><a href="classPV_1_1Movie.html#ada08079aab340c4d4338962a9d77192f">PV::Movie::ioParam_flipOnTimescaleError</a></div><div class="ttdeci">virtual void ioParam_flipOnTimescaleError(enum ParamsIOFlag ioFlag)</div><div class="ttdoc">flipOnTimescaleError: determines whether to change images at the end of the display period if the HyP...</div><div class="ttdef"><b>Definition:</b> <a href="Movie_8cpp_source.html#l00283">Movie.cpp:283</a></div></div>
<div class="ttc" id="classPV_1_1Movie_html_abbf7eeb308dd947092df41fb0277cb5f"><div class="ttname"><a href="classPV_1_1Movie.html#abbf7eeb308dd947092df41fb0277cb5f">PV::Movie::ioParam_skip_frame_index</a></div><div class="ttdeci">virtual void ioParam_skip_frame_index(enum ParamsIOFlag ioFlag)</div><div class="ttdoc">skip_frame_index: If skip_frame_index=1, go to the next frame at the end of the display period...</div><div class="ttdef"><b>Definition:</b> <a href="Movie_8cpp_source.html#l00336">Movie.cpp:336</a></div></div>
<div class="ttc" id="classPV_1_1Image_html_a8d1cc57a56a99c5e742803a669ee137b"><div class="ttname"><a href="classPV_1_1Image.html#a8d1cc57a56a99c5e742803a669ee137b">PV::Image::ioParamsFillGroup</a></div><div class="ttdeci">virtual int ioParamsFillGroup(enum ParamsIOFlag ioFlag)</div><div class="ttdef"><b>Definition:</b> <a href="Image_8cpp_source.html#l00094">Image.cpp:94</a></div></div>
<div class="ttc" id="classPV_1_1Movie_html_a4dd7fd5e516257b38ff600d081f394bd"><div class="ttname"><a href="classPV_1_1Movie.html#a4dd7fd5e516257b38ff600d081f394bd">PV::Movie::retrieveData</a></div><div class="ttdeci">virtual int retrieveData(double timef, double dt)</div><div class="ttdef"><b>Definition:</b> <a href="Movie_8cpp_source.html#l00570">Movie.cpp:570</a></div></div>
<div class="ttc" id="classPV_1_1Movie_html_a4999705acea89ca9bcb729253fe095a0"><div class="ttname"><a href="classPV_1_1Movie.html#a4999705acea89ca9bcb729253fe095a0">PV::Movie::outputState</a></div><div class="ttdeci">virtual int outputState(double time, bool last=false)</div><div class="ttdef"><b>Definition:</b> <a href="Movie_8cpp_source.html#l00677">Movie.cpp:677</a></div></div>
<div class="ttc" id="classPV_1_1HyPerLayer_html_a33a6e33be986fdc9ea02471e48e7a158"><div class="ttname"><a href="classPV_1_1HyPerLayer.html#a33a6e33be986fdc9ea02471e48e7a158">PV::HyPerLayer::needUpdate</a></div><div class="ttdeci">virtual bool needUpdate(double time, double dt)</div><div class="ttdef"><b>Definition:</b> <a href="HyPerLayer_8cpp_source.html#l01582">HyPerLayer.cpp:1582</a></div></div>
<div class="ttc" id="classPV_1_1Movie_html_a0e11210c5169806856ebd9b25597befa"><div class="ttname"><a href="classPV_1_1Movie.html#a0e11210c5169806856ebd9b25597befa">PV::Movie::ioParamsFillGroup</a></div><div class="ttdeci">virtual int ioParamsFillGroup(enum ParamsIOFlag ioFlag)</div><div class="ttdef"><b>Definition:</b> <a href="Movie_8cpp_source.html#l00245">Movie.cpp:245</a></div></div>
<div class="ttc" id="classPV_1_1BaseInput_html_a5287d7e1488696f3d8ecbaf2d9465597"><div class="ttname"><a href="classPV_1_1BaseInput.html#a5287d7e1488696f3d8ecbaf2d9465597">PV::BaseInput::writeImage</a></div><div class="ttdeci">int writeImage(const char *filename, int batchIdx)</div><div class="ttdef"><b>Definition:</b> <a href="BaseInput_8cpp_source.html#l00847">BaseInput.cpp:847</a></div></div>
<div class="ttc" id="classPV_1_1Movie_html_ac3e3d39db3b527d2ea5dcb8b3c0e97d5"><div class="ttname"><a href="classPV_1_1Movie.html#ac3e3d39db3b527d2ea5dcb8b3c0e97d5">PV::Movie::getDeltaUpdateTime</a></div><div class="ttdeci">virtual double getDeltaUpdateTime()</div><div class="ttdef"><b>Definition:</b> <a href="Movie_8cpp_source.html#l00537">Movie.cpp:537</a></div></div>
<div class="ttc" id="namespacePV_html_adb616cc87488824fc1d4bf93fea0814b"><div class="ttname"><a href="namespacePV.html#adb616cc87488824fc1d4bf93fea0814b">PV::PV_fwrite</a></div><div class="ttdeci">size_t PV_fwrite(const void *RESTRICT ptr, size_t size, size_t nitems, PV_Stream *RESTRICT pvstream)</div><div class="ttdoc">A wrapper for fwrite() with feedback for errors and the possibility of error recovery.  The syntax and purpose of PV_fwrite follows that of the standard C function fwrite(), with the following changes. The FILE* argument is replaced with a PV_Stream* pointer, and the additional argument verify (which defaults to true) provides some error checking. </div><div class="ttdef"><b>Definition:</b> <a href="fileio_8cpp_source.html#l00260">fileio.cpp:260</a></div></div>
<div class="ttc" id="classPV_1_1Movie_html_acf2039738a817b781d7515f9e8af46da"><div class="ttname"><a href="classPV_1_1Movie.html#acf2039738a817b781d7515f9e8af46da">PV::Movie::ioParam_start_frame_index</a></div><div class="ttdeci">virtual void ioParam_start_frame_index(enum ParamsIOFlag ioFlag)</div><div class="ttdoc">start_frame_index: Initialize the layer with the given frame. </div><div class="ttdef"><b>Definition:</b> <a href="Movie_8cpp_source.html#l00327">Movie.cpp:327</a></div></div>
<div class="ttc" id="classPV_1_1HyPerCol_html_a436bb917c4024424c8bde1bd0ef71fe3"><div class="ttname"><a href="classPV_1_1HyPerCol.html#a436bb917c4024424c8bde1bd0ef71fe3">PV::HyPerCol::getVerifyWrites</a></div><div class="ttdeci">bool getVerifyWrites()</div><div class="ttdef"><b>Definition:</b> <a href="HyPerCol_8hpp_source.html#l00092">HyPerCol.hpp:92</a></div></div>
<div class="ttc" id="classPV_1_1Movie_html_a99c40879fd368921aa76cc12698323b7"><div class="ttname"><a href="classPV_1_1Movie.html#a99c40879fd368921aa76cc12698323b7">PV::Movie::ioParam_displayPeriod</a></div><div class="ttdeci">virtual void ioParam_displayPeriod(enum ParamsIOFlag ioFlag)</div><div class="ttdoc">displayPeriod: the amount of time each image is displayed before switching to the next image...</div><div class="ttdef"><b>Definition:</b> <a href="Movie_8cpp_source.html#l00287">Movie.cpp:287</a></div></div>
<div class="ttc" id="structPVLayerLoc___html"><div class="ttname"><a href="structPVLayerLoc__.html">PVLayerLoc_</a></div><div class="ttdef"><b>Definition:</b> <a href="PVLayerLoc_8h_source.html#l00024">PVLayerLoc.h:24</a></div></div>
<div class="ttc" id="classPV_1_1Movie_html_a3c93227b2ed6fa4583679916d681432a"><div class="ttname"><a href="classPV_1_1Movie.html#a3c93227b2ed6fa4583679916d681432a">PV::Movie::ioParam_movieOutputPath</a></div><div class="ttdeci">virtual void ioParam_movieOutputPath(enum ParamsIOFlag ioFlag)</div><div class="ttdoc">movieOutputPath: </div><div class="ttdef"><b>Definition:</b> <a href="Movie_8cpp_source.html#l00344">Movie.cpp:344</a></div></div>
<div class="ttc" id="classPV_1_1HyPerLayer_html_a70b5cd86852df8df6a7aa2ee13248ca0"><div class="ttname"><a href="classPV_1_1HyPerLayer.html#a70b5cd86852df8df6a7aa2ee13248ca0">PV::HyPerLayer::setNextUpdateTime</a></div><div class="ttdeci">virtual void setNextUpdateTime(double in)</div><div class="ttdef"><b>Definition:</b> <a href="HyPerLayer_8hpp_source.html#l00385">HyPerLayer.hpp:385</a></div></div>
<div class="ttc" id="classPV_1_1BaseInput_html_a9de070e226b4a755130ba50fd2fb606f"><div class="ttname"><a href="classPV_1_1BaseInput.html#a9de070e226b4a755130ba50fd2fb606f">PV::BaseInput::getFrame</a></div><div class="ttdeci">virtual int getFrame(double timef, double dt)</div><div class="ttdef"><b>Definition:</b> <a href="BaseInput_8cpp_source.html#l00353">BaseInput.cpp:353</a></div></div>
<div class="ttc" id="namespacePV_html"><div class="ttname"><a href="namespacePV.html">PV</a></div><div class="ttdef"><b>Definition:</b> <a href="Communicator_8cpp_source.html#l00016">Communicator.cpp:16</a></div></div>
<div class="ttc" id="classPV_1_1Movie_html_a7def03ad1189739a8f6c02f18d94ac00"><div class="ttname"><a href="classPV_1_1Movie.html#a7def03ad1189739a8f6c02f18d94ac00">PV::Movie::ioParam_resetToStartOnLoop</a></div><div class="ttdeci">virtual void ioParam_resetToStartOnLoop(enum ParamsIOFlag ioFlag)</div><div class="ttdoc">resetToStartOnLoop: If false, then when the end of file for the imageListPath file is reached...</div><div class="ttdef"><b>Definition:</b> <a href="Movie_8cpp_source.html#l00355">Movie.cpp:355</a></div></div>
<div class="ttc" id="classPV_1_1Movie_html_a30957bada05b3d7b85fd66bce0b5375b"><div class="ttname"><a href="classPV_1_1Movie.html#a30957bada05b3d7b85fd66bce0b5375b">PV::Movie::ioParam_writeFrameToTimestamp</a></div><div class="ttdeci">virtual void ioParam_writeFrameToTimestamp(enum ParamsIOFlag ioFlag)</div><div class="ttdoc">writeFrameToTimestamp: if true, then every time the frame is updated, it writes the frame number...</div><div class="ttdef"><b>Definition:</b> <a href="Movie_8cpp_source.html#l00351">Movie.cpp:351</a></div></div>
<div class="ttc" id="classPV_1_1BaseInput_html_a7b420ec4776779f5fc3ed9a92811f1e3"><div class="ttname"><a href="classPV_1_1BaseInput.html#a7b420ec4776779f5fc3ed9a92811f1e3">PV::BaseInput::checkpointRead</a></div><div class="ttdeci">virtual int checkpointRead(const char *cpDir, double *timeptr)</div><div class="ttdef"><b>Definition:</b> <a href="BaseInput_8cpp_source.html#l00813">BaseInput.cpp:813</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_46a221571c56bf3fcf15f3c317ca6a89.html">layers</a></li><li class="navelem"><b>Movie.cpp</b></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>
